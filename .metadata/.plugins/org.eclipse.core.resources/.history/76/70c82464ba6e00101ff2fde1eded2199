package JDBCExamples;

import java.sql.*;

public class ExampleOne {

    public static void main(String[] args) {
    	String url = "jdbc:mysql://localhost:3306/hospital"; // Replace with your DB name
        String username = "root"; // Replace with your MySQL username
        String password = "12345"; // Replace with your MySQL password

        try {
            // Load MySQL JDBC Driver
            Class.forName("com.mysql.cj.jdbc.Driver");

            // Connect to the database
            Connection conn = DriverManager.getConnection(url, username, password);
            System.out.println("Connected to the database.");

            // INSERT operation
            String insertSQL = "INSERT INTO patients (id, name, age, disease) VALUES (?, ?, ?, ?)";
            PreparedStatement insertStmt = conn.prepareStatement(insertSQL);
            insertStmt.setInt(1, 1);
            insertStmt.setString(2, "John Doe");
            insertStmt.setInt(3, 30);
            insertStmt.setString(4, "Flu");
            int inserted = insertStmt.executeUpdate();
            System.out.println(inserted + " row(s) inserted.");

            // UPDATE operation
            String updateSQL = "UPDATE patients SET age = ? WHERE id = ?";
            PreparedStatement updateStmt = conn.prepareStatement(updateSQL);
            updateStmt.setInt(1, 31);
            updateStmt.setInt(2, 1);
            int updated = updateStmt.executeUpdate();
            System.out.println(updated + " row(s) updated.");

            // SELECT operation
            String selectSQL = "SELECT * FROM patients";
            Statement selectStmt = conn.createStatement();
            ResultSet rs = selectStmt.executeQuery(selectSQL);

            System.out.println("\nPatient Records:");
            while (rs.next()) {
                int id = rs.getInt("id");
                String name = rs.getString("name");
                int age = rs.getInt("age");
                String disease = rs.getString("disease");

                System.out.println("ID: " + id + ", Name: " + name + ", Age: " + age + ", Disease: " + disease);
            }

            
            rs.close();
            insertStmt.close();
            updateStmt.close();
            selectStmt.close();
            conn.close();

        } catch (ClassNotFoundException e) {
            System.out.println("MySQL JDBC Driver not found.");
            e.printStackTrace();
        } catch (SQLException e) {
            System.out.println("SQL Exception occurred.");
            e.printStackTrace();
        }
    }
}
